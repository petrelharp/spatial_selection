\documentclass{article}
\usepackage{fullpage} 
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}

\newcommand{\E}{\mathbb{E}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\var}{\mathop{\mbox{Var}}}
\newcommand{\Exp}{\mathop{\mbox{Exp}}}

\begin{document}

Consider a largeish occupied patch of habitat in which an allele is beneficial ($s_b$),
surrounded by habitat where it is deleterious ($s_d$).
The allele is present in surrounding areas at low frequency due to migration-selection balance.
We want the first time that another patch at distance $x$ is successfully colonized.

The general picture:
\begin{itemize}

\item The excursions sufficiently far from the patch are like subcritical branching processes,
with mean $1-s_d$ and variance $\xi^2$.

\item An excursion that makes it to the new patch in $k$ copies establishes with probability $1-(1-p_s)^k$,
where $p_s \approx 2s_b/\xi^2$, so establishment has approximate probability $2 k s_b / \xi^2$.

\item The probability that the branching process lives for $t$ generations is asymptotically a constant ($\phi$, below) times $(1-s_d)^t$.

\item Conditioned on living for time $t$, the process can be represented by a single lineage whose offspring distribution
is the original distribution, conditioned to be nonzero, minus one.
(Also, it is known that conditional on being alive at $t\to\infty$, the allele is present in $K$ copies; where $K$ has mean $1/\phi$ and variance calculated below.)

\item Spatial motion is independent of branching;
so we can take the motion of the trunk lineage to be Brownian;
the chance that the motion first hits $x$ at time $t$ is (Borodin \& Salminen 2.02)
\[
\frac{x}{t^{3/2}\sqrt{2\pi}} \exp\left(-\frac{x^2}{2t}\right) .
\]

\item Therefore, the probability that an excursion makes it to $x$ at time $t$ is asymptotically
\[
  (1-s_d)^t \phi \frac{x}{t^{3/2}\sqrt{2\pi}} \exp\left(-\frac{x^2}{2t}\right) ,
\]
or the chance that it is still alive then time the chance the trunk lineage hits $x$ at that time.

\item This induces a distribution on $T$, the time that a successful excursion took to cross:
assuming, as is asymptotically correct, that the number of arriving lineages is independent of how long it took to get there,
if $\tau_x$ is the random time of arrival of a successful lineage,
\[
 \P\{\tau_x \in dt\} \propto \frac{(1-s_d)^t}{t^{3/2}} \exp\left(-\frac{x^2}{2t}\right) .
\]


\item The length of the hitchhiking segment on \emph{one side} of the selected site $L$ is exponential with rate depending on $T$;
integrating over $T$ we get
(using Gradshteyn \& Ryzhik 3.471.9; note $\ell > 0 > \log(1-s_d)$):
\begin{align*}
 \P\{ L > \ell \} &= \E\left[ e^{-\ell \tau_x} \right] \\
 & \propto \int_0^\infty \frac{1}{t^{3/2}} \exp\left(-\frac{x^2}{2t} + t(\log(1-s_d) -\ell) \right)  dt \\
 &= \frac{\sqrt{2\pi}}{x} e^{-x\sqrt{2(\ell-\log(1-s_d))}} ;
\end{align*}
hence, defining $\alpha = - \log(1-s_d) > 0$,
\begin{align*}
 \P\{ L > \ell \} &= \E\left[ e^{-\ell \tau_x} \right] = \exp\left\{{-x\left(\sqrt{2(\ell+\alpha)} - \sqrt{2\alpha}\right)}\right\} \qquad \mbox{for}\; \ell>0.
\end{align*}
This is a shifted Weibull distribution, or equivalently, $L=X^2-\alpha$, where $X$ is a Exponential with rate $x\sqrt{2}$ conditioned to be at least $\sqrt{\alpha}$.
Note that the total length of a hitchhiking segment is the sum of two independent copies of this.

\item We could rescale with $x$ and get a limiting distribution for $\tau_x$:
\begin{align*}
  \E\left[\exp\left( -\ell \frac{\tau_x}{x} \right)\right]
        &= \exp\left\{ - x\sqrt{2}\left(\sqrt{\frac{\ell}{x}+\alpha} - \sqrt{\alpha}\right) \right\} \\
        &\xrightarrow{x\to\infty} \exp\left\{ - \frac{\ell}{\sqrt{2\alpha}} \right\} ,
\end{align*}
implying that $\tau_x/x \xrightarrow{a.s.} 1/\sqrt{2\alpha}$.

\item Ok, but how about the CLT?  Differentiating, we see that $\E[\tau_x]=x/\sqrt{2\alpha}$ and $\var[\tau_x]=x/2^{3/2}\alpha^{3/2}$,
which suggests looking at
\begin{align*}
\E\left[\exp\left( -\ell \left(\frac{\tau_x-x/\sqrt{2\alpha}}{\sqrt{x}} \right) \right)\right]
    &= \exp\left\{ - x\sqrt{2}\left(\sqrt{\frac{\ell}{\sqrt{x}}+\alpha} - \sqrt{\alpha}\right) + \frac{\ell}{\sqrt{2\alpha x}} \right\} \\
    &\simeq \exp\left\{ - x\sqrt{2}\left( \frac{\ell}{2\sqrt{\alpha x}} - \frac{\ell^2}{8\alpha^{3/2}x}  \right) + \frac{\ell}{\sqrt{2\alpha x}} \right\} \\
    &= \exp\left\{ \frac{\ell^2}{2^{5/2}\alpha^{3/2}} \right\} ,
\end{align*}
since $\sqrt{\alpha+\epsilon}=\sqrt{\alpha} +\epsilon/2\sqrt{\alpha}-\epsilon^2/8\alpha^{3/2} + O(\epsilon^3)$.
The Laplace transform of a $N(0,\sigma^2)$ is $\exp(\ell^2\sigma^2/2)$, so
\[
\frac{\tau_x - x/\sqrt{2\alpha}}{\sqrt{x}} \xrightarrow{d} N(0,2^{-3/2}\alpha^{-3/2}) \qquad \mbox{as}\;x\to\infty.
\]

\item Translating this limit law back to $L$, we have that
\[
  \tau \simeq \frac{x}{2\alpha} + 2\sqrt{2\alpha^3x} B,
\]
with $B \sim N(0,1)$; since $L \sim \Exp(\tau)$,
\[
  \frac{x}{\sqrt{2\alpha}} L \simeq \Exp\left(1+\frac{4\alpha^2}{\sqrt{x}}B\right) \xrightarrow{x\to\infty} \Exp(1),
\]
i.e.\ $L$ is approximately a Exponential with rate $\sqrt{2\alpha}/x$.

\item Note: if we wanted to kill the motion at some negative location (returns to original patch)
we'd use the result for BM, on p.296 of Feller.

\end{itemize}



\subsection{$K$ and $\phi$}

From Jagers, section 2.6,
the mean and variance of $K$ are as follows.
Let the probability of $k$ offpsring be $p_k$ and let
\[
 f(u) =  \sum_k p_k u^k,
\]
and $f_n$ the $n^\mathrm{th}$ composition of $f$.
Note that the mean number of offspring is $1-s_d = f'(1)$, and the variance is $\xi^2 = f''(1) + f'(1)(1-f'(1)) = f''(1) + s_d(1-s_d)$.
If $\sum_k p_k k \log k < \infty$, then 
\[
\phi = \lim_{n \to \infty} \frac{ \P\{ \mbox{survival to }n \}  }{ (1-s_d)^n } = \lim_{n \to \infty} \frac{ 1-f_n(0) }{ (1-s_d)^n } > 0 .
\]
Furthermore,
\begin{gather*}
\E[K] = 1/\phi \qquad \mbox{and} \\
\E[K(K-1)] = \frac{ f''(1) }{ \phi s_d (1-s_d) } \qquad \mbox{so} \\
\var[K] = \frac{1}{\phi} \left( \frac{ \xi^2 }{ s_d (1-s_d) } + \frac{1}{1-\phi} - 1 \right) .
\end{gather*}
Note additionally that 
\[
    1 - \frac{1-f_n(u)}{1-f_n(0)} \searrow g(u) = \E[u^K] .
\]

\end{document}
